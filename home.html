<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>In√≠cio - ByteWay</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&display=swap" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/4.1.1/animate.min.css"/>

    <style>
        :root {
            --bg: linear-gradient(180deg, #1a0505 0%, #000000 100%);
            --card: rgba(255, 255, 255, 0.05);
            --red: #e74c3c;
            --green: #2ecc71;
            --gold: #FFD700;
            --telegram: #0088cc;
        }

        /* REMOVENDO O CONTORNO AZUL DE SELE√á√ÉO E FOCO */
        * { 
            margin: 0; 
            padding: 0; 
            box-sizing: border-box; 
            font-family: 'Inter', sans-serif; 
            outline: none !important; 
            -webkit-tap-highlight-color: transparent; 
        }

        body { background: var(--bg); color: white; padding-bottom: 110px; min-height: 100vh; overflow-x: hidden; }

        /* MURAL DE AVISO DIN√ÇMICO */
        #container-aviso {
            display: none;
            margin: 10px 20px;
            padding: 15px;
            background: rgba(231, 76, 60, 0.15);
            border: 1px solid rgba(231, 76, 60, 0.3);
            border-radius: 15px;
            color: #fff;
            font-size: 0.85rem;
            text-align: center;
            animation: pulse 2s infinite;
        }

        @keyframes pulse {
            0% { box-shadow: 0 0 0 0 rgba(231, 76, 60, 0.4); }
            70% { box-shadow: 0 0 0 10px rgba(231, 76, 60, 0); }
            100% { box-shadow: 0 0 0 0 rgba(231, 76, 60, 0); }
        }

        /* Top Bar */
        .top-bar { padding: 25px; display: flex; justify-content: space-between; align-items: center; }
        .logo-home { font-weight: 700; font-size: 1.2rem; letter-spacing: -1px; }
        .logo-home span { color: var(--red); }
        .user-greeting h2 { font-size: 1.1rem; text-transform: capitalize; }

        /* Portfolio Card */
        .portfolio-card { 
            margin: 0 20px; background: var(--card); border-radius: 25px; 
            padding: 25px; border: 1px solid rgba(255,255,255,0.1);
            box-shadow: 0 15px 35px rgba(0,0,0,0.4);
        }
        .portfolio-header { text-align: center; margin-bottom: 20px; border-bottom: 1px solid rgba(255,255,255,0.05); padding-bottom: 15px; }
        .portfolio-header small { color: #888; text-transform: uppercase; font-size: 0.65rem; letter-spacing: 1px; }
        .balance-main { font-size: 2.2rem; font-weight: 700; color: #fff; display: flex; align-items: center; justify-content: center; gap: 10px; }
        
        .stats-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 15px; margin-top: 15px; }
        .stat-item { background: rgba(0,0,0,0.2); padding: 12px; border-radius: 15px; border: 1px solid rgba(255,255,255,0.03); }
        .stat-item span { display: block; font-size: 0.65rem; color: #888; text-transform: uppercase; margin-bottom: 5px; }
        .stat-item strong { font-size: 0.95rem; color: #fff; }

        /* VIP Badges */
        .vip-badge { display: inline-flex; align-items: center; gap: 5px; padding: 4px 12px; border-radius: 50px; font-size: 0.65rem; font-weight: 800; text-transform: uppercase; }
        .vip-bronze { background: #3d1a1a; color: #ff9999; }
        .vip-ouro { background: linear-gradient(90deg, #ffd700, #b8860b); color: #000; }
        .vip-diamante { background: linear-gradient(90deg, #e5e4e2, #7f8c8d); color: #000; }

        /* Bot√µes de A√ß√£o */
        .actions-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 15px; padding: 20px; }
        .action-btn { background: var(--card); border-radius: 18px; padding: 18px; text-align: center; color: white; text-decoration: none; border: 1px solid rgba(255,255,255,0.05); }
        .action-btn i { font-size: 1.6rem; margin-bottom: 10px; display: block; color: var(--red); }

        /* Listas de Investimentos */
        .plans-stack { padding: 15px 20px; display: flex; flex-direction: column; gap: 15px; }
        .active-plan-item { background: linear-gradient(135deg, rgba(255, 255, 255, 0.08) 0%, rgba(255, 255, 255, 0.03) 100%); border-radius: 22px; padding: 18px; border: 1px solid rgba(255, 255, 255, 0.1); position: relative; overflow: hidden; }
        .plan-progress-bg { height: 4px; background: rgba(255,255,255,0.05); border-radius: 10px; width: 100%; margin-top: 10px; }
        
        .plan-progress-bar { 
            height: 100%; background: var(--red); border-radius: 10px; 
            box-shadow: 0 0 10px var(--red); 
            transition: width 1s linear;
        }

        /* Telegram Button */
        .btn-tg {
            position: fixed; bottom: 85px; right: 20px; background: var(--telegram);
            width: 50px; height: 50px; border-radius: 50%; display: flex;
            align-items: center; justify-content: center; color: white;
            font-size: 1.5rem; z-index: 999; text-decoration: none;
            box-shadow: 0 4px 15px rgba(0,0,0,0.4);
        }

        /* Social Pop */
        .social-pop { position: fixed; bottom: 85px; left: 20px; right: 80px; background: white; color: #333; padding: 12px 15px; border-radius: 15px; display: flex; align-items: center; gap: 12px; box-shadow: 0 10px 30px rgba(0,0,0,0.5); z-index: 9998; transform: translateX(-150%); transition: 0.5s ease-in-out; }
        .social-pop.show { transform: translateX(0); }

        /* Nav Bottom COM EFEITO VIDRO VERMELHO NO ATIVO */
        .nav-bottom { 
            position: fixed; 
            bottom: 0; 
            left: 0; 
            width: 100%; 
            background: rgba(0, 0, 0, 0.9); 
            display: flex; 
            justify-content: space-around; 
            padding: 12px 0; 
            border-top: 1px solid rgba(255,255,255,0.1); 
            backdrop-filter: blur(10px);
        }
        .nav-item { 
            color: #555; 
            text-align: center; 
            text-decoration: none; 
            font-size: 0.7rem; 
            padding: 8px 12px;
            border-radius: 15px;
            transition: 0.3s;
        }
        .nav-item i { display: block; font-size: 1.3rem; margin-bottom: 5px; }

        .nav-item.active { 
            color: #fff; 
            background: rgba(231, 76, 60, 0.2); 
            border: 1px solid rgba(231, 76, 60, 0.4);
            box-shadow: 0 0 15px rgba(231, 76, 60, 0.2);
        }
        .nav-item.active i { color: var(--red); }
    </style>
</head>
<body>

    <a href="https://t.me/+Z6pv35vKSuA4MDhh" target="_blank" class="btn-tg"><i class="fab fa-telegram-plane"></i></a>

    <div id="social-pop" class="social-pop">
        <i class="fas fa-check-circle" style="color: #2ecc71;"></i>
        <p id="social-content" style="font-size: 0.75rem;"></p>
    </div>

    <div id="container-aviso" class="animate__animated animate__fadeInDown">
        <i class="fas fa-bullhorn" style="margin-right: 8px; color: var(--red);"></i>
        <span id="texto-aviso"></span>
    </div>

    <div class="top-bar">
        <div class="user-greeting">
            <div class="logo-home"><span>Byte</span>Way</div>
            <h2 id="home-nome">Carregando...</h2>
        </div>
        <a href="perfil.html" style="color:white; font-size: 1.5rem;"><i class="fas fa-user-circle"></i></a>
    </div>

    <div class="portfolio-card">
        <div class="portfolio-header">
            <div id="vip-tag" class="vip-badge vip-bronze">
                <i class="fas fa-crown"></i> <span id="vip-nome">VIP Bronze</span>
            </div>
            <br><small>Saldo Total Conta</small>
            <div class="balance-main">
                <span id="home-saldo">R$ 0,00</span>
                <i class="fas fa-eye" id="toggle-balance" style="font-size: 1.2rem; color: rgba(255,255,255,0.2); cursor: pointer;"></i>
            </div>
        </div>
        <div class="stats-grid">
            <div class="stat-item"><span>Total Investido</span><strong id="stat-investido">R$ 0,00</strong></div>
            <div class="stat-item"><span>Total Ganhos</span><strong id="stat-ganhos" style="color:var(--green)">R$ 0,00</strong></div>
            <div class="stat-item"><span>Para Investir</span><strong id="stat-investir">R$ 0,00</strong></div>
            <div class="stat-item"><span>Para Saque</span><strong id="stat-saque">R$ 0,00</strong></div>
        </div>
    </div>

    <div class="actions-grid">
        <a href="deposito.html" class="action-btn"><i class="fas fa-wallet"></i>Depositar</a>
        <a href="saque.html" class="action-btn"><i class="fas fa-hand-holding-usd"></i>Sacar</a>
    </div>

    <h3 style="padding: 0 25px; font-size: 0.8rem; color: #666; text-transform: uppercase; font-weight: 700;">Meus Investimentos</h3>
    <div id="lista-investimentos" class="plans-stack"></div>

    <nav class="nav-bottom">
        <a href="home.html" class="nav-item active"><i class="fas fa-home"></i>In√≠cio</a>
        <a href="planos.html" class="nav-item"><i class="fas fa-chart-pie"></i>Planos</a>
        <a href="indicacao.html" class="nav-item"><i class="fas fa-share-alt"></i>Indicar</a>
        <a href="perfil.html" class="nav-item"><i class="fas fa-user-alt"></i>Perfil</a>
    </nav>

    <script type="module">
        import { initializeApp } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-app.js";
        import { getAuth, onAuthStateChanged, signOut } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-auth.js";
        import { getFirestore, doc, getDoc, collection, query, where, getDocs, updateDoc, addDoc, Timestamp, increment, onSnapshot, orderBy, limit } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore.js";

        const firebaseConfig = {
            apiKey: "AIzaSyDKDFw7khZzM9hIX7xbbrbFQeESiCLnmOw",
    authDomain: "monety-site-9175f.firebaseapp.com",
    projectId: "monety-site-9175f",
    storageBucket: "monety-site-9175f.firebasestorage.app",
    messagingSenderId: "840821848803",
    appId: "1:840821848803:web:b99a5528e4bb925518a3d6"
        };

        const app = initializeApp(firebaseConfig);
        const auth = getAuth(app);
        const db = getFirestore(app);

        // --- SISTEMA DE NOTIFICA√á√ïES (SOCIAL PROOF) ---
        const nomes_pop = ["Marcos S.", "Julia R.", "Phelipe A.", "Ana Paula", "Bruno K.", "Carlos G.", "Diego M."];
        const tipos_pop = ["acabou de sacar", "recebeu lucro de", "ativou um novo plano"];
        function showPop() {
            const pop = document.getElementById('social-pop');
            const content = document.getElementById('social-content');
            if(!pop || !content) return;
            const nome = nomes_pop[Math.floor(Math.random()*nomes_pop.length)];
            const tipo = tipos_pop[Math.floor(Math.random()*tipos_pop.length)];
            const valor = (Math.random() * (450 - 30) + 30).toFixed(2);
            content.innerHTML = `<b>${nome}</b> ${tipo} <span style="color:#2ecc71; font-weight:700">R$ ${valor}</span>`;
            pop.classList.add('show');
            setTimeout(() => pop.classList.remove('show'), 4000);
        }
        setInterval(showPop, 12000);

        // --- MURAL DE AVISO DIN√ÇMICO ---
        async function carregarAviso() {
            try {
                const docRef = doc(db, "configuracoes", "aviso_global");
                const snap = await getDoc(docRef);
                if (snap.exists() && snap.data().texto.trim() !== "") {
                    document.getElementById('texto-aviso').innerText = snap.data().texto;
                    document.getElementById('container-aviso').style.display = 'block';
                }
            } catch (e) { console.error("Erro aviso:", e); }
        }

        // --- FUN√á√ÉO PARA ANIMAR AS BARRAS ---
        function iniciarAnimacaoProgresso() {
            setInterval(() => {
                const agora = new Date().getTime();
                document.querySelectorAll('.progress-timer').forEach(bar => {
                    const inicio = parseInt(bar.getAttribute('data-inicio'));
                    const fim = bar.getAttribute('data-fim');
                    if (fim) {
                        const total = parseInt(fim) - inicio;
                        const decorrido = agora - inicio;
                        let percentagem = (decorrido / total) * 100;
                        if (percentagem > 100) percentagem = 100;
                        if (percentagem < 0) percentagem = 0;
                        bar.style.width = percentagem.toFixed(4) + '%';
                    }
                });
            }, 1000);
        }

        // --- NOVA FUN√á√ÉO: VERIFICAR DEP√ìSITO RECENTE (OFFLINE/HOME) ---
        async function verificarDepositoRecente(uid) {
            if (sessionStorage.getItem('notificacaoDepositoExibida')) return;
            try {
                const historicoRef = collection(db, "historico");
                const q = query(historicoRef, where("userId", "==", uid), where("tipo", "==", "Dep√≥sito"), orderBy("data", "desc"), limit(1));
                const snap = await getDocs(q);
                if (!snap.empty) {
                    const dados = snap.docs[0].data();
                    const dataDep = dados.data.toDate();
                    const agora = new Date();
                    const diffMinutos = (agora - dataDep) / (1000 * 60);
                    if (diffMinutos <= 15) {
                        sessionStorage.setItem('notificacaoDepositoExibida', 'true');
                        notificarDeposito(dados.valor);
                    }
                }
            } catch (e) { console.error("Erro dep√≥sito recente:", e); }
        }

        // --- MENSAGEM DE DEP√ìSITO CONFIRMADO (TEXTO ORIGINAL) ---
        function notificarDeposito(valor) {
            Swal.fire({
                title: `<span style="color: #2ecc71;">Dep√≥sito Confirmado!</span>`,
                html: `
                    <div style="text-align: center; margin-bottom: 20px;">
                        <div style="background: rgba(46, 204, 113, 0.1); width: 60px; height: 60px; border-radius: 50%; display: flex; align-items: center; justify-content: center; margin: 0 auto 15px; border: 2px solid #2ecc71;">
                            <i class="fas fa-wallet" style="color: #2ecc71; font-size: 1.8rem;"></i>
                        </div>
                        <h3 style="color: #fff; font-size: 1.3rem;">+ R$ ${Number(valor).toFixed(2).replace('.', ',')}</h3>
                        <p style="font-size: 0.85rem; color: #aaa;">O seu dep√≥sito via PIX j√° foi processado e adicionado √† sua conta com sucesso.</p>
                    </div>
                `,
                background: '#120303',
                color: '#fff',
                borderRadius: '25px',
                confirmButtonText: 'OK, ENTENDIDO',
                confirmButtonColor: '#2ecc71',
                showClass: { popup: 'animate__animated animate__bounceIn' }
            });
        }

        onAuthStateChanged(auth, async (user) => {
            if (user) {
                onSnapshot(doc(db, "usuarios", user.uid), async (snap) => {
                    if (snap.exists()) {
                        const userData = snap.data();
                        if (userData.status === "bloqueado") {
                            await signOut(auth);
                            window.location.href = "login.html?error=blocked";
                            return;
                        }
                        await sincronizarDados(user.uid, userData);
                        carregarAviso();
                        verificarDepositoRecente(user.uid);
                    }
                });
            } else {
                window.location.href = "login.html";
            }
        });

        async function sincronizarDados(uid, userData) {
            try {
                document.getElementById('home-nome').innerText = `Ol√°, ${userData.nome || "Investidor"}`;

                let totalInvestido = 0;
                let htmlContent = "";
                const agora = new Date();
                const vinteQuatroHoras = 24 * 60 * 60 * 1000;
                let saldoVisivel = localStorage.getItem('saldoVisivel') !== 'false';

                const q = query(collection(db, "investimentos"), where("userId", "==", uid), where("status", "==", "ativo"));
                const snap = await getDocs(q);
                let ganhosParaCreditar = 0;
                const updates = [];

                for (const docInv of snap.docs) {
                    const inv = docInv.data();
                    const dataCriacao = inv.timestamp.toDate();
                    const dataExpiracao = inv.dataExpiracao?.toDate();

                    if (dataExpiracao && agora > dataExpiracao) {
                        updates.push(updateDoc(doc(db, "investimentos", docInv.id), { status: "finalizado" }));
                        continue;
                    }

                    // CORRE√á√ÉO DEFINITIVA: 
                    // Se o investimento √© novo, diff ser√° quase 0. Ele s√≥ entra se diff for >= 24h (86.400.000 ms)
                    const dataReferencia = inv.ultimoPagamento ? inv.ultimoPagamento.toDate() : dataCriacao;
                    const diff = agora.getTime() - dataReferencia.getTime();

                    if (diff >= vinteQuatroHoras) {
                        const ciclos = Math.floor(diff / vinteQuatroHoras);
                        if (ciclos > 0) {
                            // Usamos o rendimentoDiario do banco para garantir que n√£o confunda com o valor do plano
                            ganhosParaCreditar += (Number(inv.rendimentoDiario) * ciclos);
                            
                            const novoTempoMilis = dataReferencia.getTime() + (ciclos * vinteQuatroHoras);
                            const novoHorarioFixo = Timestamp.fromMillis(novoTempoMilis);
                            
                            updates.push(updateDoc(doc(db, "investimentos", docInv.id), { ultimoPagamento: novoHorarioFixo }));
                        }
                    }

                    totalInvestido += Number(inv.valor);
                    let progresso = 0;
                    if (dataExpiracao) {
                        const totalPlano = dataExpiracao - dataCriacao;
                        const decorrido = agora - dataCriacao;
                        progresso = Math.min(100, Math.max(0, (decorrido / totalPlano) * 100));
                    }

                    htmlContent += `
                        <div class="active-plan-item animate__animated animate__fadeInUp">
                            <div style="display:flex; justify-content:space-between; align-items:center">
                                <div>
                                    <h4 style="font-size:0.95rem; font-weight:700"><i class="fas fa-layer-group" style="color:var(--red); margin-right:5px;"></i> ${inv.plano}</h4>
                                    <small style="color:var(--green); font-weight:600"><i class="fas fa-arrow-up"></i> + R$ ${Number(inv.rendimentoDiario).toFixed(2)} / dia</small>
                                </div>
                                <div style="text-align:right">
                                    <strong style="font-size:1rem">R$ ${Number(inv.valor).toFixed(2)}</strong>
                                    <br><small style="color:#888; font-size:0.6rem; text-transform:uppercase">Investido</small>
                                </div>
                            </div>
                            <div class="plan-progress-bg">
                                <div class="plan-progress-bar progress-timer" 
                                     data-inicio="${dataCriacao.getTime()}" 
                                     data-fim="${dataExpiracao ? dataExpiracao.getTime() : ''}" 
                                     style="width:${progresso}%">
                                </div>
                            </div>
                        </div>`;
                }

                if (updates.length > 0) await Promise.all(updates);

                document.getElementById('lista-investimentos').innerHTML = htmlContent || '<p style="text-align:center; color:#444; font-size:0.85rem; margin-top:20px;">Nenhum investimento ativo.</p>';
                iniciarAnimacaoProgresso();

                const vipTag = document.getElementById('vip-tag');
                const vipNome = document.getElementById('vip-nome');
                if (totalInvestido >= 2000) { vipTag.className = "vip-badge vip-diamante"; vipNome.innerText = "VIP Diamante"; }
                else if (totalInvestido >= 500) { vipTag.className = "vip-badge vip-ouro"; vipNome.innerText = "VIP Ouro"; }
                else { vipTag.className = "vip-badge vip-bronze"; vipNome.innerText = "VIP Bronze"; }

                const processarLucros = async () => {
                    if (ganhosParaCreditar > 0) {
                        await updateDoc(doc(db, "usuarios", uid), {
                            saldoLucro: increment(ganhosParaCreditar),
                            totalGanhos: increment(ganhosParaCreditar)
                        });
                        await addDoc(collection(db, "historico"), {
                            userId: uid, valor: ganhosParaCreditar, tipo: 'Rendimento', descricao: 'Lucro Di√°rio de Plano Ativo', data: Timestamp.now()
                        });
                        
                        await Swal.fire({
                            title: `<span style="color: #2ecc71;">Lucro Creditado!</span>`,
                            html: `
                                <div style="text-align: center; margin-bottom: 20px;">
                                    <div style="background: rgba(46, 204, 113, 0.1); width: 60px; height: 60px; border-radius: 50%; display: flex; align-items: center; justify-content: center; margin: 0 auto 15px; border: 2px solid #2ecc71;">
                                        <i class="fas fa-money-bill-wave" style="color: #2ecc71; font-size: 1.8rem;"></i>
                                    </div>
                                    <h3 style="color: #fff; font-size: 1.3rem;">+ R$ ${ganhosParaCreditar.toFixed(2).replace('.', ',')}</h3>
                                    <p style="font-size: 0.85rem; color: #aaa;">O rendimento dos seus planos ativos foi adicionado ao seu saldo de forma autom√°tica.</p>
                                </div>
                                <div style="background: rgba(255,255,255,0.05); padding: 15px; border-radius: 20px; border: 1px solid rgba(255,255,255,0.1); text-align: left;">
                                    <div style="display: flex; justify-content: space-between; margin-bottom: 8px;">
                                        <span style="color: #888; font-size: 0.8rem;">Opera√ß√£o:</span>
                                        <span style="color: #fff; font-size: 0.8rem; font-weight: 600;">Rendimento Di√°rio</span>
                                    </div>
                                    <div style="display: flex; justify-content: space-between;">
                                        <span style="color: #888; font-size: 0.8rem;">Status:</span>
                                        <span style="color: #2ecc71; font-size: 0.8rem; font-weight: 600;"><i class="fas fa-check-circle"></i> Conclu√≠do com Sucesso</span>
                                    </div>
                                </div>
                            `,
                            background: '#120303',
                            color: '#fff',
                            borderRadius: '25px',
                            confirmButtonText: 'EXCELENTE',
                            confirmButtonColor: '#2ecc71',
                            showClass: { popup: 'animate__animated animate__backInDown' },
                            hideClass: { popup: 'animate__animated animate__fadeOutDown' }
                        });
                        location.reload();
                    }
                };

                if (!sessionStorage.getItem('notificacaoBoasVindas')) {
                    Swal.fire({
                        title: `<span style="color: #e74c3c;">Byte</span>Way Intelligence`,
                        html: `
                            <div style="text-align: center; margin-bottom: 20px;">
                                <h3 style="color: #fff; font-size: 1.2rem;">Bem-vindo ao Futuro, ${userData.nome || "Investidor"}! üöÄ</h3>
                                <p style="font-size: 0.85rem; color: #aaa;">Sua conta foi ativada com sucesso. Veja como come√ßar a lucrar:</p>
                            </div>
                            <div style="text-align: left; font-size: 0.85rem; display: flex; flex-direction: column; gap: 12px;">
                                <div style="background: rgba(255,255,255,0.05); padding: 12px; border-radius: 20px; border: 1px solid rgba(46, 204, 113, 0.2); display: flex; align-items: center; gap: 15px;">
                                    <div style="background: #2ecc71; width: 40px; height: 40px; border-radius: 12px; display: flex; align-items: center; justify-content: center; font-size: 1.2rem; color: #000;"><i class="fas fa-chart-line"></i></div>
                                    <div><b style="color: #2ecc71; display: block;">Rendimentos Di√°rios</b><span style="color: #ccc;">Seus lucros s√£o creditados automaticamente a cada 24 horas exatas.</span></div>
                                </div>
                                <div style="background: rgba(255,255,255,0.05); padding: 12px; border-radius: 20px; border: 1px solid rgba(255, 215, 0, 0.2); display: flex; align-items: center; gap: 15px;">
                                    <div style="background: #FFD700; width: 40px; height: 40px; border-radius: 12px; display: flex; align-items: center; justify-content: center; font-size: 1.2rem; color: #000;"><i class="fas fa-users"></i></div>
                                    <div><b style="color: #FFD700; display: block;">Sistema de Afiliados</b><span style="color: #ccc;">Ganhe b√¥nus de rede em at√© 3 gera√ß√µes por cada novo indicado ativo.</span></div>
                                </div>
                                <div style="background: rgba(255,255,255,0.05); padding: 12px; border-radius: 20px; border: 1px solid rgba(231, 76, 60, 0.2); display: flex; align-items: center; gap: 15px;">
                                    <div style="background: #e74c3c; width: 40px; height: 40px; border-radius: 12px; display: flex; align-items: center; justify-content: center; font-size: 1.2rem; color: #fff;"><i class="fas fa-shield-alt"></i></div>
                                    <div><b style="color: #e74c3c; display: block;">Saques R√°pidos</b><span style="color: #ccc;">M√≠nimo de R$ 35,00 para solicitar sua retirada via PIX a qualquer momento.</span></div>
                                </div>
                            </div>
                            <p style="margin-top: 20px; font-size: 0.75rem; color: #666; text-align: center;">ByteWay &copy; 2025 - Gest√£o de Ativos Digitais</p>
                        `,
                        background: '#120303',
                        color: '#fff',
                        borderRadius: '25px',
                        confirmButtonText: 'VAMOS LUCRAR AGORA',
                        confirmButtonColor: '#e74c3c',
                        showClass: { popup: 'animate__animated animate__zoomIn' },
                        hideClass: { popup: 'animate__animated animate__zoomOut' }
                    }).then(() => {
                        sessionStorage.setItem('notificacaoBoasVindas', 'true');
                        processarLucros();
                    });
                } else {
                    processarLucros();
                }

                const atualizarUI = () => {
                    const format = (v) => saldoVisivel ? `R$ ${Number(v || 0).toFixed(2).replace('.', ',')}` : "R$ ******";
                    const saldoTotalCalculado = (Number(userData.saldo) || 0) + (Number(userData.saldoLucro) || 0);
                    document.getElementById('home-saldo').innerText = format(saldoTotalCalculado);
                    document.getElementById('stat-investido').innerText = format(totalInvestido);
                    document.getElementById('stat-ganhos').innerText = format(userData.totalGanhos || 0);
                    document.getElementById('stat-investir').innerText = format(userData.saldo); 
                    document.getElementById('stat-saque').innerText = format(userData.saldoLucro); 
                    document.getElementById('toggle-balance').className = saldoVisivel ? "fas fa-eye" : "fas fa-eye-slash";
                };

                document.getElementById('toggle-balance').onclick = () => {
                    saldoVisivel = !saldoVisivel;
                    localStorage.setItem('saldoVisivel', saldoVisivel);
                    atualizarUI();
                };
                atualizarUI();

            } catch (e) { console.error("Erro sincroniza√ß√£o:", e); }
        }
    </script>
</body>
</html>
